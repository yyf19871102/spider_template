/**
 * @author yangyufei
 * @date 2019-03-05 09:09:20
 * @desc
 */
const Redis         = require('ioredis');

exports.getInstance = (config, logger, role) => {
    let cfg = config || {host: '127.0.0.1', port: 6379};

    let redis = Array.isArray(config) ? new Redis.Cluster(config) : new Redis(config);

    redis.on('error', err => {
        logger.error('redis发生错误！');
        logger.error(err);
        process.exit(1);
    });

    redis.on('connect', () => logger.trace(`redisManager连接启动${role}`));
    redis.on('close', () => logger.warn(`redisManager关闭连接${role}`));

    return redis;
};